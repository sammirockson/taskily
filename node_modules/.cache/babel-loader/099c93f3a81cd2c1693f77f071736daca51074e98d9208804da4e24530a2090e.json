{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, openBlock, createElementBlock } from 'vue';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\nfunction __generator(thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (g && (g = 0, op[0] && (_ = 0)), _) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\n/*\n* (c) Copyright Ascensio System SIA 2024\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*     http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\nvar loadScript = function (url, id) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2 /*return*/, new Promise(function (resolve, reject) {\n        try {\n          // If DocsAPI is defined return resolve.\n          //@ts-ignore\n          if (window.DocsAPI) return resolve(null);\n          var existedScript_1 = document.getElementById(id);\n          if (existedScript_1) {\n            // If the script element is found, wait for it to load.\n            var intervalHandler_1 = setInterval(function () {\n              var loading = existedScript_1.getAttribute(\"loading\");\n              if (loading) {\n                // If the download is not completed, continue to wait.\n                return;\n              } else {\n                // If the download is completed, stop the wait.\n                clearInterval(intervalHandler_1);\n                // If DocsAPI is defined, after loading return resolve.\n                //@ts-ignore\n                if (window.DocsAPI) return resolve(null);\n                // If DocsAPI is not defined, delete the existing script and create a new one.\n                var script = _createScriptTag(id, url, resolve, reject);\n                existedScript_1.remove();\n                document.body.appendChild(script);\n              }\n            }, 500);\n          } else {\n            // If the script element is not found, create it.\n            var script = _createScriptTag(id, url, resolve, reject);\n            document.body.appendChild(script);\n          }\n        } catch (e) {\n          console.error(e);\n        }\n      })];\n    });\n  });\n};\nvar _createScriptTag = function (id, url, resolve, reject) {\n  var script = document.createElement(\"script\");\n  script.id = id;\n  script.type = \"text/javascript\";\n  script.src = url;\n  script.async = true;\n  script.onload = function () {\n    // Remove attribute loading after loading is complete.\n    script.removeAttribute(\"loading\");\n    resolve(null);\n  };\n  script.onerror = function (error) {\n    // Remove attribute loading after loading is complete.\n    script.removeAttribute(\"loading\");\n    reject(error);\n  };\n  script.setAttribute(\"loading\", \"\");\n  return script;\n};\nvar script = defineComponent({\n  name: 'DocumentEditor',\n  props: {\n    id: {\n      type: String,\n      required: true\n    },\n    documentServerUrl: {\n      type: String,\n      required: true\n    },\n    config: {\n      type: Object,\n      required: true\n    },\n    document_fileType: String,\n    document_title: String,\n    documentType: String,\n    editorConfig_lang: String,\n    height: String,\n    type: String,\n    width: String,\n    onLoadComponentError: Function,\n    events_onAppReady: Function,\n    events_onDocumentStateChange: Function,\n    events_onMetaChange: Function,\n    events_onDocumentReady: Function,\n    events_onInfo: Function,\n    events_onWarning: Function,\n    events_onError: Function,\n    events_onRequestSharingSettings: Function,\n    events_onRequestRename: Function,\n    events_onMakeActionLink: Function,\n    events_onRequestInsertImage: Function,\n    events_onRequestSaveAs: Function,\n    /**\n     * @deprecated Deprecated since version 7.5, please use events_onRequestSelectSpreadsheet instead.\n     */\n    events_onRequestMailMergeRecipients: Function,\n    /**\n     * @deprecated Deprecated since version 7.5, please use events_onRequestSelectDocument instead.\n     */\n    events_onRequestCompareFile: Function,\n    events_onRequestEditRights: Function,\n    events_onRequestHistory: Function,\n    events_onRequestHistoryClose: Function,\n    events_onRequestHistoryData: Function,\n    events_onRequestRestore: Function,\n    events_onRequestSelectSpreadsheet: Function,\n    events_onRequestSelectDocument: Function\n  },\n  mounted: function () {\n    var _this = this;\n    var url = this.documentServerUrl;\n    if (!url.endsWith(\"/\")) url += \"/\";\n    var docApiUrl = \"\".concat(url, \"web-apps/apps/api/documents/api.js\");\n    loadScript(docApiUrl, \"onlyoffice-api-script\").then(function () {\n      return _this.onLoad();\n    }).catch(function () {\n      _this.onError(-2);\n    });\n  },\n  unmounted: function () {\n    var _a;\n    var id = this.id || \"\";\n    if ((_a = window === null || window === void 0 ? void 0 : window.DocEditor) === null || _a === void 0 ? void 0 : _a.instances[id]) {\n      window.DocEditor.instances[id].destroyEditor();\n      window.DocEditor.instances[id] = undefined;\n    }\n  },\n  watch: {\n    config: {\n      handler: function (newVal, oldVal) {\n        this.onChangeProps();\n      },\n      deep: true\n    },\n    document_fileType: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    document_title: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    documentType: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    editorConfig_lang: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    height: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    type: function (newVal, oldVal) {\n      this.onChangeProps();\n    },\n    width: function (newVal, oldVal) {\n      this.onChangeProps();\n    }\n  },\n  methods: {\n    onLoad: function () {\n      var _a, _b;\n      try {\n        var id = this.id || \"\";\n        if (!window.DocsAPI) this.onError(-3);\n        if ((_a = window === null || window === void 0 ? void 0 : window.DocEditor) === null || _a === void 0 ? void 0 : _a.instances[id]) {\n          console.log(\"Skip loading. Instance already exists\", id);\n          return;\n        }\n        if (!((_b = window === null || window === void 0 ? void 0 : window.DocEditor) === null || _b === void 0 ? void 0 : _b.instances)) {\n          window.DocEditor = {\n            instances: {}\n          };\n        }\n        var initConfig = Object.assign({\n          document: {\n            fileType: this.document_fileType,\n            title: this.document_title\n          },\n          documentType: this.documentType,\n          editorConfig: {\n            lang: this.editorConfig_lang\n          },\n          events: {\n            onAppReady: this.onAppReady,\n            onDocumentStateChange: this.events_onDocumentStateChange,\n            onMetaChange: this.events_onMetaChange,\n            onDocumentReady: this.events_onDocumentReady,\n            onInfo: this.events_onInfo,\n            onWarning: this.events_onWarning,\n            onError: this.events_onError,\n            onRequestSharingSettings: this.events_onRequestSharingSettings,\n            onRequestRename: this.events_onRequestRename,\n            onMakeActionLink: this.events_onMakeActionLink,\n            onRequestInsertImage: this.events_onRequestInsertImage,\n            onRequestSaveAs: this.events_onRequestSaveAs,\n            onRequestMailMergeRecipients: this.events_onRequestMailMergeRecipients,\n            onRequestCompareFile: this.events_onRequestCompareFile,\n            onRequestEditRights: this.events_onRequestEditRights,\n            onRequestHistory: this.events_onRequestHistory,\n            onRequestHistoryClose: this.events_onRequestHistoryClose,\n            onRequestHistoryData: this.events_onRequestHistoryData,\n            onRequestRestore: this.events_onRequestRestore,\n            onRequestSelectSpreadsheet: this.events_onRequestSelectSpreadsheet,\n            onRequestSelectDocument: this.events_onRequestSelectDocument\n          },\n          height: this.height,\n          type: this.type,\n          width: this.width\n        }, this.config || {});\n        var editor = window.DocsAPI.DocEditor(id, initConfig);\n        window.DocEditor.instances[id] = editor;\n      } catch (err) {\n        console.error(err);\n        this.onError(-1);\n      }\n    },\n    onError: function (errorCode) {\n      var message;\n      switch (errorCode) {\n        case -2:\n          message = \"Error load DocsAPI from \" + this.documentServerUrl;\n          break;\n        case -3:\n          message = \"DocsAPI is not defined\";\n          break;\n        default:\n          message = \"Unknown error loading component\";\n          errorCode = -1;\n      }\n      if (typeof this.onLoadComponentError == \"undefined\") {\n        console.error(message);\n      } else {\n        this.onLoadComponentError(errorCode, message);\n      }\n    },\n    onAppReady: function () {\n      var id = this.id || \"\";\n      this.events_onAppReady(window.DocEditor.instances[id]);\n    },\n    onChangeProps: function () {\n      var _a;\n      var id = this.id || \"\";\n      if ((_a = window === null || window === void 0 ? void 0 : window.DocEditor) === null || _a === void 0 ? void 0 : _a.instances[id]) {\n        window.DocEditor.instances[id].destroyEditor();\n        window.DocEditor.instances[id] = undefined;\n        console.log(\"Important props have been changed. Load new Editor.\");\n        this.onLoad();\n      }\n    }\n  }\n});\nconst _hoisted_1 = [\"id\"];\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    id: _ctx.id\n  }, null, 8 /* PROPS */, _hoisted_1);\n}\nscript.render = render;\nscript.__file = \"src/components/DocumentEditor.vue\";\nexport { script as DocumentEditor };","map":{"version":3,"names":["loadScript","url","id","__awaiter","Promise","resolve","reject","window","DocsAPI","existedScript_1","document","getElementById","intervalHandler_1","setInterval","loading","getAttribute","clearInterval","script","_createScriptTag","remove","body","appendChild","e","console","error","createElement","type","src","async","onload","removeAttribute","onerror","setAttribute","defineComponent","name","props","String","required","documentServerUrl","config","Object","document_fileType","document_title","documentType","editorConfig_lang","height","width","onLoadComponentError","Function","events_onAppReady","events_onDocumentStateChange","events_onMetaChange","events_onDocumentReady","events_onInfo","events_onWarning","events_onError","events_onRequestSharingSettings","events_onRequestRename","events_onMakeActionLink","events_onRequestInsertImage","events_onRequestSaveAs","events_onRequestMailMergeRecipients","events_onRequestCompareFile","events_onRequestEditRights","events_onRequestHistory","events_onRequestHistoryClose","events_onRequestHistoryData","events_onRequestRestore","events_onRequestSelectSpreadsheet","events_onRequestSelectDocument","mounted","_this","endsWith","docApiUrl","concat","then","onLoad","catch","onError","unmounted","_a","DocEditor","instances","destroyEditor","undefined","watch","handler","newVal","oldVal","onChangeProps","deep","methods","log","_b","initConfig","assign","fileType","title","editorConfig","lang","events","onAppReady","onDocumentStateChange","onMetaChange","onDocumentReady","onInfo","onWarning","onRequestSharingSettings","onRequestRename","onMakeActionLink","onRequestInsertImage","onRequestSaveAs","onRequestMailMergeRecipients","onRequestCompareFile","onRequestEditRights","onRequestHistory","onRequestHistoryClose","onRequestHistoryData","onRequestRestore","onRequestSelectSpreadsheet","onRequestSelectDocument","editor","err","errorCode","message"],"sources":["../src/utils/loadScript.ts","../src/components/DocumentEditor.vue"],"sourcesContent":["/*\r\n* (c) Copyright Ascensio System SIA 2024\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*     http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n*/\r\n\r\nconst loadScript = async (url: string, id: string) => {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      // If DocsAPI is defined return resolve.\r\n      //@ts-ignore\r\n      if (window.DocsAPI) return resolve(null);\r\n\r\n      const existedScript = document.getElementById(id);\r\n\r\n      if (existedScript) {\r\n        // If the script element is found, wait for it to load.\r\n        let intervalHandler = setInterval(() => {\r\n          const loading = existedScript.getAttribute(\"loading\");\r\n          if (loading) {\r\n            // If the download is not completed, continue to wait.\r\n            return;\r\n          } else {\r\n            // If the download is completed, stop the wait.\r\n            clearInterval(intervalHandler);\r\n\r\n            // If DocsAPI is defined, after loading return resolve.\r\n            //@ts-ignore\r\n            if (window.DocsAPI) return resolve(null);\r\n\r\n            // If DocsAPI is not defined, delete the existing script and create a new one.\r\n            const script = _createScriptTag(id, url, resolve, reject);\r\n            existedScript.remove();\r\n            document.body.appendChild(script);\r\n          }\r\n        }, 500);\r\n      } else {\r\n        // If the script element is not found, create it.\r\n        const script = _createScriptTag(id, url, resolve, reject);\r\n        document.body.appendChild(script);\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n  });\r\n};\r\n\r\nconst _createScriptTag = (id: string, url: string, resolve: (value: unknown) => void, reject: (reason?: any) => void) => {\r\n  const script = document.createElement(\"script\");\r\n\r\n  script.id = id;\r\n  script.type = \"text/javascript\";\r\n  script.src = url;\r\n  script.async = true;\r\n\r\n  script.onload = () => {\r\n    // Remove attribute loading after loading is complete.\r\n    script.removeAttribute(\"loading\");\r\n    resolve(null);\r\n  };\r\n  script.onerror = (error: any) => {\r\n    // Remove attribute loading after loading is complete.\r\n    script.removeAttribute(\"loading\");\r\n    reject(error);\r\n  };\r\n\r\n  script.setAttribute(\"loading\", \"\");\r\n\r\n  return script;\r\n};\r\n\r\nexport default loadScript;\r\n","/*\r\n* (c) Copyright Ascensio System SIA 2024\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*     http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n*/\r\n\r\n<template>\r\n  <div :id=\"id\"></div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, PropType } from 'vue';\r\nimport loadScript from \"../utils/loadScript\";\r\nimport { IConfig } from \"../model/config\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    DocsAPI?: any;\r\n    DocEditor?: any;\r\n  }\r\n}\r\n\r\nexport default defineComponent({\r\n  name: 'DocumentEditor',\r\n  props: {\r\n    id: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    documentServerUrl: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    config: {\r\n      type: Object as PropType<IConfig>,\r\n      required: true\r\n    },\r\n    document_fileType: String,\r\n    document_title: String,\r\n    documentType: String,\r\n    editorConfig_lang: String,\r\n    height: String,\r\n    type: String,\r\n    width: String,\r\n\r\n    onLoadComponentError: Function,\r\n\r\n    events_onAppReady: Function,\r\n    events_onDocumentStateChange: Function,\r\n    events_onMetaChange: Function,\r\n    events_onDocumentReady: Function,\r\n    events_onInfo: Function,\r\n    events_onWarning: Function,\r\n    events_onError: Function,\r\n    events_onRequestSharingSettings: Function,\r\n    events_onRequestRename: Function,\r\n    events_onMakeActionLink: Function,\r\n    events_onRequestInsertImage: Function,\r\n    events_onRequestSaveAs: Function,\r\n    /**\r\n     * @deprecated Deprecated since version 7.5, please use events_onRequestSelectSpreadsheet instead.\r\n     */\r\n    events_onRequestMailMergeRecipients: Function,\r\n    /**\r\n     * @deprecated Deprecated since version 7.5, please use events_onRequestSelectDocument instead.\r\n     */\r\n    events_onRequestCompareFile: Function,\r\n    events_onRequestEditRights: Function,\r\n    events_onRequestHistory: Function,\r\n    events_onRequestHistoryClose: Function,\r\n    events_onRequestHistoryData: Function,\r\n    events_onRequestRestore: Function,\r\n    events_onRequestSelectSpreadsheet: Function,\r\n    events_onRequestSelectDocument: Function,\r\n  },\r\n  mounted() {\r\n    let url = this.documentServerUrl;\r\n    if (!url!.endsWith(\"/\")) url += \"/\";\r\n\r\n    const docApiUrl = `${url}web-apps/apps/api/documents/api.js`;\r\n    loadScript(docApiUrl, \"onlyoffice-api-script\")\r\n      .then(() => this.onLoad())\r\n      .catch(()=> {this.onError(-2)});\r\n  },\r\n  unmounted() {\r\n    const id = this.id || \"\";\r\n\r\n    if (window?.DocEditor?.instances[id]) {\r\n      window.DocEditor.instances[id].destroyEditor();\r\n      window.DocEditor.instances[id] = undefined;\r\n    }\r\n  },\r\n  watch: {\r\n    config: {\r\n      handler: function (newVal, oldVal) {\r\n        this.onChangeProps()     \r\n      },\r\n      deep: true\r\n    },\r\n    document_fileType: function(newVal, oldVal) { this.onChangeProps() },\r\n    document_title: function(newVal, oldVal) { this.onChangeProps() },\r\n    documentType: function(newVal, oldVal) { this.onChangeProps() },\r\n    editorConfig_lang: function(newVal, oldVal) { this.onChangeProps() },\r\n    height: function(newVal, oldVal) { this.onChangeProps() },\r\n    type: function(newVal, oldVal) { this.onChangeProps() },\r\n    width: function(newVal, oldVal) { this.onChangeProps() }\r\n  },\r\n  methods: {\r\n    onLoad () {\r\n       try {\r\n        const id = this.id || \"\";\r\n\r\n        if (!window.DocsAPI) this.onError(-3);\r\n        if (window?.DocEditor?.instances[id]) {\r\n          console.log(\"Skip loading. Instance already exists\", id);\r\n          return;\r\n        }\r\n\r\n        if (!window?.DocEditor?.instances) {\r\n          window.DocEditor = { instances: {} };\r\n        }\r\n\r\n        let initConfig = Object.assign({\r\n          document: {\r\n            fileType: this.document_fileType,\r\n            title: this.document_title,\r\n          },\r\n          documentType: this.documentType,\r\n          editorConfig: {\r\n            lang: this.editorConfig_lang,\r\n          },\r\n          events: {\r\n            onAppReady: this.onAppReady,\r\n            onDocumentStateChange: this.events_onDocumentStateChange,\r\n            onMetaChange: this.events_onMetaChange,\r\n            onDocumentReady: this.events_onDocumentReady,\r\n            onInfo: this.events_onInfo,\r\n            onWarning: this.events_onWarning,\r\n            onError: this.events_onError,\r\n            onRequestSharingSettings: this.events_onRequestSharingSettings,\r\n            onRequestRename: this.events_onRequestRename,\r\n            onMakeActionLink: this.events_onMakeActionLink,\r\n            onRequestInsertImage: this.events_onRequestInsertImage,\r\n            onRequestSaveAs: this.events_onRequestSaveAs,\r\n            onRequestMailMergeRecipients: this.events_onRequestMailMergeRecipients,\r\n            onRequestCompareFile: this.events_onRequestCompareFile,\r\n            onRequestEditRights: this.events_onRequestEditRights,\r\n            onRequestHistory: this.events_onRequestHistory,\r\n            onRequestHistoryClose: this.events_onRequestHistoryClose,\r\n            onRequestHistoryData: this.events_onRequestHistoryData,\r\n            onRequestRestore: this.events_onRequestRestore,\r\n            onRequestSelectSpreadsheet: this.events_onRequestSelectSpreadsheet,\r\n            onRequestSelectDocument: this.events_onRequestSelectDocument\r\n          },\r\n          height: this.height,\r\n          type: this.type,\r\n          width: this.width,\r\n        }, this.config || {});\r\n\r\n        const editor = window.DocsAPI.DocEditor(id, initConfig);\r\n        window.DocEditor.instances[id] = editor;\r\n      } catch (err: any) {\r\n        console.error(err);\r\n        this.onError(-1);\r\n      }\r\n    },\r\n    onError(errorCode: Number) {\r\n      let message;\r\n\r\n      switch(errorCode) {\r\n        case -2:\r\n          message = \"Error load DocsAPI from \" + this.documentServerUrl;\r\n          break;\r\n        case -3:\r\n          message = \"DocsAPI is not defined\";\r\n          break;\r\n        default:\r\n          message = \"Unknown error loading component\";\r\n          errorCode = -1;\r\n      }\r\n\r\n      if (typeof this.onLoadComponentError == \"undefined\") {\r\n        console.error(message);\r\n      } else {\r\n        this.onLoadComponentError(errorCode, message);\r\n      }\r\n    },\r\n    onAppReady() {\r\n      const id = this.id || \"\";\r\n      this.events_onAppReady!(window.DocEditor.instances[id]);\r\n    },\r\n    onChangeProps () {\r\n      const id = this.id || \"\";\r\n\r\n      if (window?.DocEditor?.instances[id]) {\r\n        window.DocEditor.instances[id].destroyEditor();\r\n        window.DocEditor.instances[id] = undefined;\r\n  \r\n        console.log(\"Important props have been changed. Load new Editor.\");\r\n        this.onLoad();\r\n      }\r\n    }\r\n  }\r\n});\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}